(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"/X1Q":function(e,t,a){"use strict";var n=a("B80Q");(0,n.track)(!1)},"4mTq":function(e,t,a){"use strict";var n=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var o=n(a("bx4M"));a("14J3");var d=n(a("BMrR"));a("+L6B");var i=n(a("2/Rp"));a("jCWc");var l=n(a("kPKH"));a("5NDa");var c=n(a("5rEg")),u=n(a("MVZn"));a("5Dmo");var s=n(a("3S7+")),p=n(a("lwsE")),h=n(a("W8MJ")),f=n(a("a1gu")),m=n(a("Nsbk")),g=n(a("7W2i"));a("y8nQ");var v,y,b,x=n(a("Vl3Y")),E=r(a("q1tI")),w=a("MuoO"),N=n(a("zHco")),j=n(a("nP61")),k=n(a("cYWl")),I=n(a("wW5x")),C=x.default.Item,T=(v=(0,w.connect)(function(e){var t=e.job,a=e.task,n=e.loading;return{data:t.data,loading:n.models.job,graphDependencies:a.graphNodes,graphNodesFetchLoading:n.effects["task/fetchAllGraphNodes"]}}),y=x.default.create(),v(b=y(b=function(e){function t(){var e,a;(0,p.default)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=(0,f.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(r))),a.state={formValues:{},pagination:{pageNo:1,timeSortType:""},showGraphContainer:"hide",jobId:0},a.graphContainerRight={show:"33px",hide:""},a.scroll={x:!1},a.fixedWidth={name:"",gmtModify:"",executeRate:"",owner:"",planType:""},a.columns=[{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"name",percent:33,render:function(e,t){var n=t.id;return a.renderTooltip(e,"name",n)}},{title:"\u4fee\u6539\u65e5\u671f",dataIndex:"gmtModify",sorter:!0,percent:18,render:function(e){return a.renderTooltip(e,"gmtModify")}},{title:"\u4efb\u52a1\u7c7b\u578b",dataIndex:"planType",percent:16,render:function(e){return a.renderTooltip(e,"planType")}},{title:"\u8d23\u4efb\u4eba",dataIndex:"owner",percent:18,render:function(e){return a.renderTooltip(e,"owner")}},{title:"\u8c03\u5ea6\u7c7b\u578b",dataIndex:"executeRate",render:function(e){return a.renderTooltip(e,"executeRate")}}],a.renderTooltip=function(e,t,n){return E.default.createElement(s.default,{title:e},n?E.default.createElement("a",{href:"javascript:;",style:{maxWidth:"".concat(a.fixedWidth[t],"px")},onClick:function(e){return a.showGraph(e,n)},className:I.default.tdEllisps},e):E.default.createElement("span",{href:"javascript:;",style:{maxWidth:"".concat(a.fixedWidth[t],"px")},className:I.default.tdEllisps},e))},a.showGraph=function(e,t){e.stopPropagation(),a.setState({showGraphContainer:"show",jobId:t}),a.props.dispatch({type:"task/fetchAllGraphNodes",payload:t})},a.handleSearch=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form;r.validateFields(function(e,t){e||(a.setState({formValues:t}),n({type:"job/fetchJobs",payload:(0,u.default)({},a.state.pagination,t)}))})},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"job/fetchJobs"})},a.renderForm=function(){var e=a.props.form.getFieldDecorator;return E.default.createElement(x.default,{onSubmit:a.handleSearch,layout:"inline"},E.default.createElement(d.default,{gutter:{md:8,lg:24,xl:48},style:{display:"flex",alignItems:"center"}},E.default.createElement(l.default,{md:6,sm:24},E.default.createElement(C,{label:"\u811a\u672c\u540d\u79f0"},e("fileName")(E.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165"})))),E.default.createElement(l.default,{md:8,sm:24},E.default.createElement("span",{className:"SubmitButtons"},E.default.createElement(i.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),E.default.createElement(i.default,{style:{marginLeft:8},onClick:a.handleFormReset},"\u91cd\u7f6e")))))},a.handleGeneralTableChange=function(e,t,n){var r={};n.order?"descend"===n.order?r.timeSortType=2:r.timeSortType=1:r.timeSortType=0,r.pageNo=e.current,a.setState({pagination:r}),a.props.dispatch({type:"job/fetchJobs",payload:(0,u.default)({},r,a.state.formValues)})},a.autoFooter=function(){var e=a.props.data,t=void 0===e?{}:e,n=t.list,r=void 0===n?[]:n;if(r.length>0&&r.length<11){var o=59*(10-r.length);return E.default.createElement("div",{style:{height:"".concat(o,"px")}},E.default.createElement("div",{style:{height:"100%",width:"".concat(parseInt(a.fixedWidth.name,10)+33,"px"),borderRight:"1px solid #e8e8e8"}}))}return!1},a.hideGraphContainer=function(){a.setState({showGraphContainer:"hide"})},a}return(0,g.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"job/fetchJobs"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.data,r=void 0===n?{}:n,d=t.graphDependencies,i=t.graphNodesFetchLoading,l=document.body.clientWidth-(document.getElementsByClassName("ant-layout-sider")[0]?document.getElementsByClassName("ant-layout-sider")[0].style.width.replace("px",""):0)-48-64;this.columns=this.columns.map(function(t){return"executeRate"===t.dataIndex?(delete e.fixedWidth.executeRate,t.width=l-Object.values(e.fixedWidth).reduce(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+t},0),e.fixedWidth[t.dataIndex]="".concat(t.width-32)):(t.width=Math.floor(t.percent/100*l),e.fixedWidth[t.dataIndex]="".concat(t.width-32)),t});var c=this.fixedWidth.name,u=void 0===c?0:c,s=l-u-36,p="".concat(s,"px");return this.graphContainerRight.hide="-".concat(s+33,"px"),E.default.createElement(N.default,null,E.default.createElement(o.default,{bordered:!1,onClick:this.hideGraphContainer},E.default.createElement("div",{className:I.default.fixedHeightTableList},E.default.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{right:"".concat(this.graphContainerRight[this.state.showGraphContainer]),width:p},className:I.default.graphContainer},E.default.createElement(k.default,{fetchEffectName:"task/fetchGraphNode",loading:i,graphDependencies:d,jobPlanId:this.state.jobId})),E.default.createElement("div",{className:"CommonTableList-Form"},this.renderForm()),E.default.createElement(j.default,{rowKey:"id",bordered:!0,footer:this.autoFooter,scroll:this.scroll,loading:a,data:r,columns:this.columns,onChange:this.handleGeneralTableChange}))))}}]),t}(E.PureComponent))||b)||b),W=T;t.default=W},QgY2:function(e,t,a){},cYWl:function(e,t,a){"use strict";var n=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var o=n(a("W9HT")),d=n(a("MVZn")),i=n(a("lwsE")),l=n(a("W8MJ")),c=n(a("a1gu")),u=n(a("Nsbk")),s=n(a("7W2i")),p=r(a("q1tI")),h=a("MuoO"),f=a("LvDl");a("/X1Q");var m=n(a("B80Q")),g=n(a("hLrW"));a("QgY2");var v,y,b=n(a("MmJk")),x=n(a("n0eB")),E=3,w=(v=(0,h.connect)(function(e){var t=e.task,a=e.loading;return{newNodes:t.newNodes,graphNodeExpandLoading:a.effects["task/fetchGraphNode"]}}),v(y=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,c.default)(this,(0,u.default)(t).call(this,e)),a.g6RegisterInit=function(){m.default.registerEdge("VHV",{draw:function(e){var t=e.getGraphicGroup(),a=this.getPath(e);return t.addShape("path",{attrs:{path:a,stroke:"#00BBDB",lineWidth:2}})},getPath:function(e){var t=e.getPoints(),a=t[0],n=t[t.length-1],r=n.y-a.y,o=r/2;return[["M",a.x,a.y],["L",a.x,a.y+o],["L",n.x,a.y+o],["L",n.x,n.y]]},endArrow:{path:function(e){var t=e.getKeyShape(),a=t.attr("lineWidth");a=a>E?a:E;var n=10*a/3,r=4*a/3,o=4*a;return[["M",-n,r],["L",0,0],["L",-n,-r],["A",o,o,0,0,1,-n,r],["Z"]]},shorten:function(e){var t=e.getKeyShape(),a=t.attr("lineWidth");return 3.1*(a>E?a:E)},style:function(e){var t=e.getKeyShape(),a=t.attr(),n=a.strokeOpacity,r=a.stroke;return{fillOpacity:n,fill:r}}}}),m.default.registerNode("card",{draw:function(e){var t=e.getGraphicGroup(),a=e.getModel(),n=a.name,r=a.id,o=a.hasChildren,d=a.hasParent,i=a.input,l=void 0===i?[]:i,c=a.output,u=void 0===c?[]:c,s=188,p=46,h=14,f=14,g="",v="";o&&(v='<img class="ce-button ce-button-'.concat(r,' bottom" src=').concat(u.length>0?b.default:x.default,">")),d&&(g='<img class="ce-button ce-button-'.concat(r,' top" src=').concat(l.length>0?b.default:x.default,">"));var y=m.default.Util.createDOM('\n          <div class="card-container">\n            <h1 class="main-text">'.concat(n,'</h1>\n              <p class="value-text">').concat(n,"</p>\n          </div>\n        ")),E=t.addShape("dom",{attrs:{x:0,y:0,width:s,height:p,html:y}});return t.addShape("dom",{attrs:{x:s/2-h/2,y:p-f,width:h,height:f,html:v}}),t.addShape("dom",{attrs:{x:s/2-h/2,y:-f,width:h,height:f,html:g}}),E},anchor:[[.5,0],[.5,1]]})},a.state={graph:null,graphDependencies:{},jobPlanId:0},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=e.g6RegisterInit,a=function(e,t){Array.prototype.forEach.call(document.getElementsByClassName("ce-button-".concat(e)),function(e){e.style.display="".concat(t?"inline-block":"none")})};t();var n=new m.default.Graph({container:"mountNode",fitView:"cc",renderer:"svg",plugins:[new g.default["layout.dagre"]],defaultIntersectBox:"card"});n.node({shape:"card"}),n.edge({shape:"VHV",endArrow:!0}),n.on("node:mouseenter",function(e){var t=e.item,n=t.getModel(),r=n.id;a(r,!0)}),n.on("node:mouseleave",function(e){var t=e.item,n=t.getModel(),r=n.id;a(r,!1)}),n.on("node:click",function(t){var a=t.item,r=t.domEvent,o=a.getModel(),d=o.id,i=o.output,l=o.input,c=o.hasChildren,u=o.hasParent,s=r.target,p=s.className;if(p.indexOf("ce-button")>-1&&p.indexOf("bottom")>-1){var h=function e(t){var a=n.find(t),r=a.model,o=void 0===r?{}:r,d=o.output,i=void 0===d?[]:d,l=o.input,c=void 0===l?[]:l;i.forEach(function(t){return e(t)}),c.forEach(function(e){return n.update(e,{output:[]})}),n.remove(a)};i.length>0?i.forEach(function(e){h(e)}):c&&e.props.dispatch({type:"task/fetchGraphNode",payload:{jobPlanId:d,isTop:!1}})}else if(p.indexOf("ce-button")>-1&&p.indexOf("top")>-1){var m=[d],g=function e(t){var a=n.find(t);if(a){m.push(t);var r=a.model,o=void 0===r?{}:r,d=o.output,i=void 0===d?[]:d,l=o.input,c=void 0===l?[]:l;(0,f.uniq)(c.concat(i)).forEach(function(t){-1===m.indexOf(t)&&e(t)}),n.remove(a)}};l.length>0?(l.forEach(function(e){g(e)}),n.update(d,{input:[]})):u&&e.props.dispatch({type:"task/fetchGraphNode",payload:{jobPlanId:d,isTop:!0}})}n.setFitView("cc")}),this.setState({graph:n})}},{key:"render",value:function(){var e=this.props,t=e.loading,a=e.graphNodeExpandLoading,n={width:"100%",height:"100%"},r=(0,d.default)({display:t?"flex":"none",justifyContent:"center",alignItems:"center"},n),i=(0,d.default)({display:t?"none":"inline-block"},n),l=(0,d.default)({},r,{display:a?"flex":"none",position:"absolute",zIndex:1});return p.default.createElement(p.default.Fragment,null,p.default.createElement(o.default,{style:r}),p.default.createElement(o.default,{style:l}),p.default.createElement("div",{style:i,id:"mountNode"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!e.loading&&t.graph&&e.graphDependencies&&(!(0,f.isEqual)(t.jobPlanId,e.jobPlanId)||!(0,f.isEqual)(t.graphDependencies,e.graphDependencies)))return t.graph.read(e.graphDependencies),(0,d.default)({},t,{graphDependencies:e.graphDependencies,jobPlanId:e.jobPlanId});if(t.graph&&e.newNodes.result){var a=t.graph,n=e.newNodes,r=n.isTop,o=n.list;o.forEach(function(e){if(a.find(e.id))return!1;a.add("node",e),r?e.output.forEach(function(t){a.add("edge",{source:e.id,target:t}),a.update(t,{input:(0,f.uniq)(a.find(t).model.input.concat(e.id))})}):e.input.forEach(function(t){a.add("edge",{source:t,target:e.id}),a.update(t,{output:(0,f.uniq)(a.find(t).model.output.concat(e.id))})})})}return null}}]),t}(p.Component))||y),N=w;t.default=N},wW5x:function(e,t,a){e.exports={fixedHeightTableList:"antd-pro-main-resources-web-src-src-pages-job-job-plan-fixedHeightTableList",graphContainer:"antd-pro-main-resources-web-src-src-pages-job-job-plan-graphContainer",tdEllisps:"antd-pro-main-resources-web-src-src-pages-job-job-plan-tdEllisps"}}}]);