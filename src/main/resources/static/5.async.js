(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{CerQ:function(e,t,a){e.exports={fixedHeightTableList:"antd-pro-main-resources-web-src-src-pages-task-task-instance-fixedHeightTableList",graphContainer:"antd-pro-main-resources-web-src-src-pages-task-task-instance-graphContainer",tdEllisps:"antd-pro-main-resources-web-src-src-pages-task-task-instance-tdEllisps"}},FT0A:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),l=a.n(n);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r.apply(this,arguments)}var d=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("path",{d:"M0 0h14v14H0z"}),l.a.createElement("path",{stroke:"#BFBFBF",d:"M.5.5h13v13H.5z"}),l.a.createElement("path",{fill:"#BFBFBF",fillRule:"nonzero",d:"M3 3h8v2H3z"})),s=function(e){return l.a.createElement("svg",r({width:14,height:14},e),d)};t["default"]=s},J4nK:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),l=a.n(n);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r.apply(this,arguments)}var d=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("path",{d:"M0 0h14v14H0z"}),l.a.createElement("path",{stroke:"#BFBFBF",d:"M.5.5h13v13H.5z"}),l.a.createElement("path",{fill:"#BFBFBF",fillRule:"nonzero",d:"M3 9h8v2H3z"})),s=function(e){return l.a.createElement("svg",r({width:14,height:14},e),d)};t["default"]=s},MopB:function(e,t,a){"use strict";var n=a("284h"),l=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Pwec");var r=l(a("CtXQ")),d=l(a("lwsE")),s=l(a("W8MJ")),i=l(a("a1gu")),o=l(a("Nsbk")),c=l(a("7W2i")),u=n(a("q1tI"));a("dcsh");var f=a("a2PE"),p=l(a("J4nK")),h=l(a("FT0A")),m=l(a("wkRn")),g=l(a("rIPm")),v=l(a("vXL1")),x=l(a("yDAh")),y=l(a("v0Wj"));a("+dQi"),a("p77/"),a("1duh");var E=function(e){function t(e){var a;return(0,d.default)(this,t),a=(0,i.default)(this,(0,o.default)(t).call(this,e)),a.statuslogo={1:x.default,2:y.default,3:v.default,4:m.default,5:g.default},a.editor=null,a.expand=function(e){a.props.expandLog&&a.props.expandLog(e)},a.state={activeIndex:0},a}return(0,c.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.logs,n=t.expandLevel,l=this.state.activeIndex,d=a[l]?a[l].content:"";return u.default.createElement("div",{className:"log-wrap"},u.default.createElement("h3",{className:"log-header"},"\u4efb\u52a1\u65e5\u5fd7",u.default.createElement(r.default,{onClick:function(){return e.expand(!0)},component:h.default,style:{right:n?"28px":"8px",display:2!=n?"inline-block":"none"},className:"log-header-icon log-header-icon_top"}),u.default.createElement(r.default,{onClick:function(){return e.expand(!1)},component:p.default,style:{right:"8px",display:n?"inline-block":"none"},className:"log-header-icon log-header-icon_bottom"})),u.default.createElement("div",{className:"log-content",style:{height:"calc(100% - 32px)"}},u.default.createElement("div",{className:"log-content-left"},u.default.createElement("ul",null,a.map(function(t,a){return u.default.createElement("li",{key:a,onClick:function(){return e.setState({activeIndex:a})}},u.default.createElement(r.default,{component:e.statuslogo[t.status.id],className:"log-status"}),t.time)}))),u.default.createElement("div",{className:"log-content-right"},u.default.createElement(f.Controlled,{value:d,options:{theme:"neo",readOnly:!0},editorDidMount:function(t){e.editor=t}}))))}}]),t}(u.Component),k=E;t.default=k},VR46:function(e,t,a){"use strict";var n=a("TqRt"),l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=n(a("bx4M"));a("14J3");var d=n(a("BMrR"));a("+L6B");var s=n(a("2/Rp"));a("iQDF");var i=n(a("+eQT"));a("jCWc");var o=n(a("kPKH"));a("5NDa");var c=n(a("5rEg")),u=n(a("MVZn"));a("5Dmo");var f=n(a("3S7+"));a("Pwec");var p=n(a("CtXQ")),h=n(a("lwsE")),m=n(a("W8MJ")),g=n(a("a1gu")),v=n(a("Nsbk")),x=n(a("7W2i"));a("OaEy");var y=n(a("2fM7"));a("y8nQ");var E,k,w,b=n(a("Vl3Y")),I=l(a("q1tI")),T=a("MuoO"),C=n(a("zHco")),N=n(a("nP61")),F=n(a("cYWl")),L=n(a("Jed0")),M=n(a("MopB")),W=n(a("CerQ")),B=a("YP4+"),R=b.default.Item,S=(y.default.Option,(0,L.default)(!0)(F.default)),P=(E=(0,T.connect)(function(e){var t=e.task,a=e.loading;return{data:t.data,allStatus:t.allStatus,logs:t.logs,loading:a.effects["task/fetchInstances"],graphDependencies:t.instanceNodes,graphNodesFetchLoading:a.effects["task/fetchAllInstanceNodes"]}}),k=b.default.create(),E(w=k(w=function(e){function t(){var e,a;(0,h.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=(0,g.default)(this,(e=(0,v.default)(t)).call.apply(e,[this].concat(l))),a.state={formValues:{},pagination:{pageNo:1,date:"",bussinessTime:"",startTime:"",executeTime:""},showGraphContainer:"hide",taskId:0,expandLevel:0},a.height4Expand={0:["calc(100% - 32px)","32px"],1:["60%","40%"],2:["0","100%"]},a.graphContainerRight={show:"33px",hide:""},a.scroll={x:!1},a.fixedWidth={name:"",status:"",owner:"",type:"",bussinessTime:"",startTime:"",executeTime:""},a.columns=[{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"name",percent:20,render:function(e,t){var n=t.id;return a.renderTooltip(e,"name",n)}},{title:"\u72b6\u6001",dataIndex:"status",filters:[],percent:13,render:function(e){return I.default.createElement("span",{style:{color:B.statusColor[e.id]}},I.default.createElement(p.default,{component:B.statuslogo[e.id],style:{marginRight:"8px"}}),e.chineseName)}},{title:"\u6570\u636e\u7c7b\u578b",dataIndex:"type",percent:13,render:function(e){return a.renderTooltip(e,"type")}},{title:"\u8d23\u4efb\u4eba",dataIndex:"owner",percent:10,render:function(e){return a.renderTooltip(e,"owner")}},{title:"\u4e1a\u52a1\u65e5\u671f",dataIndex:"bussinessTime",percent:14,sorter:!0,render:function(e){return a.renderTooltip(e,"bussinessTime")}},{title:"\u5f00\u59cb\u65f6\u95f4",dataIndex:"startTime",percent:14,sorter:!0,render:function(e){return a.renderTooltip(e,"startTime")}},{title:"\u5b9a\u65f6\u65f6\u95f4",dataIndex:"executeTime",sorter:!0,render:function(e){return a.renderTooltip(e,"executeTime")}}],a.renderTooltip=function(e,t,n){return I.default.createElement(f.default,{title:e},n?I.default.createElement("a",{href:"javascript:;",style:{maxWidth:"".concat(a.fixedWidth[t],"px")},onClick:function(e){return a.showGraph(e,n)},className:W.default.tdEllisps},e):I.default.createElement("span",{href:"javascript:;",style:{maxWidth:"".concat(a.fixedWidth[t],"px")},className:W.default.tdEllisps},e))},a.showGraph=function(e,t){e.stopPropagation(),a.setState({showGraphContainer:"show",taskId:t,expandLevel:0}),a.props.dispatch({type:"task/fetchAllInstanceNodes",payload:t}),a.props.dispatch({type:"task/fetchLogs",payload:t})},a.handleSearch=function(e){e.preventDefault();var t=a.props,n=t.dispatch,l=t.form;l.validateFields(function(e,t){e||(t=(0,u.default)({},t,{date:t.date?t.date.format("YYYY-MM-DD"):""}),a.setState({formValues:t}),n({type:"task/fetchInstances",payload:(0,u.default)({},a.state.pagination,t)}))})},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"task/fetchInstances"})},a.renderForm=function(){var e=a.props.form.getFieldDecorator;return I.default.createElement(b.default,{onSubmit:a.handleSearch,layout:"inline"},I.default.createElement(d.default,{gutter:{md:8,lg:24,xl:48},style:{display:"flex",alignItems:"center"}},I.default.createElement(o.default,{md:6,sm:24},I.default.createElement(R,{label:"\u811a\u672c\u540d\u79f0"},e("filename")(I.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165"})))),I.default.createElement(o.default,{md:6,sm:24},I.default.createElement(R,{label:"\u6267\u884c\u65f6\u95f4"},e("date")(I.default.createElement(i.default,null)))),I.default.createElement(o.default,{md:6,sm:24},I.default.createElement("span",{className:"SubmitButtons"},I.default.createElement(s.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),I.default.createElement(s.default,{style:{marginLeft:8},onClick:a.handleFormReset},"\u91cd\u7f6e")))))},a.handleGeneralTableChange=function(e,t,n){var l=(0,u.default)({sortName:"",sortType:0},t);n.columnKey&&(l.sortName=n.columnKey,"descend"===n.order?l.sortType=2:l.sortType=1),l.pageNo=e.current,a.setState({pagination:l}),a.props.dispatch({type:"task/fetchInstances",payload:(0,u.default)({},l,a.state.formValues)})},a.autoFooter=function(){var e=a.props.data,t=void 0===e?{}:e,n=t.list,l=void 0===n?[]:n;if(l.length>0&&l.length<11){var r=59*(10-l.length);return I.default.createElement("div",{style:{height:"".concat(r,"px")}},I.default.createElement("div",{style:{height:"100%",width:"".concat(parseInt(a.fixedWidth.name,10)+32+parseInt(a.fixedWidth.status,10)+33,"px"),borderRight:"1px solid #e8e8e8"}}))}return!1},a.hideGraphContainer=function(){a.setState({showGraphContainer:"hide"})},a.expandLog=function(e){var t=a.state.expandLevel;e?a.setState({expandLevel:t+1}):a.setState({expandLevel:t-1})},a}return(0,x.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"task/fetchInstances"}),e({type:"task/fetchAllStatus"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.data,l=void 0===n?{}:n,d=t.graphDependencies,s=t.graphNodesFetchLoading,i=t.allStatus,o=t.logs,c=document.body.clientWidth-(document.getElementsByClassName("ant-layout-sider")[0]?document.getElementsByClassName("ant-layout-sider")[0].style.width.replace("px",""):0)-48-64;this.columns=this.columns.map(function(t){return"executeTime"===t.dataIndex?(delete e.fixedWidth.executeTime,t.width=c-Object.values(e.fixedWidth).reduce(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+t},0),e.fixedWidth[t.dataIndex]="".concat(t.width-32)):(t.width=Math.floor(t.percent/100*c),e.fixedWidth[t.dataIndex]="".concat(t.width-32)),"status"===t.dataIndex&&0===t.filters.length&&(t.filters=i.map(function(e){return{text:e.chineseName,value:e.id}})),t});var u=this.fixedWidth,f=u.name,p=void 0===f?0:f,h=u.status,m=void 0===h?0:h,g=c-p-m-36-32,v="".concat(g,"px");return this.graphContainerRight.hide="-".concat(g+33,"px"),I.default.createElement(C.default,null,I.default.createElement(r.default,{bordered:!1,onClick:this.hideGraphContainer},I.default.createElement("div",{className:W.default.fixedHeightTableList},I.default.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{right:"".concat(this.graphContainerRight[this.state.showGraphContainer]),width:v},className:W.default.graphContainer},I.default.createElement("div",{style:{height:this.height4Expand[this.state.expandLevel][0],width:"100%"}},I.default.createElement(S,{loading:s,graphDependencies:d,nodeId:this.state.taskId,payloadKey:"taskInstanceId"})),I.default.createElement("div",{style:{height:this.height4Expand[this.state.expandLevel][1],width:"100%"}},I.default.createElement(M.default,{logs:o,expandLog:this.expandLog,expandLevel:this.state.expandLevel}))),I.default.createElement("div",{className:"CommonTableList-Form"},this.renderForm()),I.default.createElement(N.default,{rowKey:"id",bordered:!0,footer:this.autoFooter,scroll:this.scroll,loading:a,data:l,columns:this.columns,onChange:this.handleGeneralTableChange}))))}}]),t}(I.PureComponent))||w)||w),D=P;t.default=D},dcsh:function(e,t,a){}}]);